## 项目总结：**psy-platform** (心理学实验平台)

### 🎯 项目概述

这是一个**心理学实验平台**，名为"自由写作"，用于管理和运行心理学相关的用户实验。该平台支持用户参与写作实验，并能够通过 AI（GPT）生成图片提示词并调用图像生成引擎创建图片。

### 🛠️ 技术栈

| 分类           | 技术                      |
| -------------- | ------------------------- |
| **框架**       | Next.js 14.2 (App Router) |
| **语言**       | TypeScript 5.4            |
| **数据库**     | MySQL + Prisma ORM        |
| **认证**       | next-auth                 |
| **样式**       | Tailwind CSS + DaisyUI    |
| **状态管理**   | Zustand                   |
| **表单**       | React Hook Form + Zod     |
| **富文本编辑** | TipTap                    |
| **任务队列**   | Bull + Redis (ioredis)    |
| **AI 集成**    | OpenAI / Azure OpenAI     |
| **存储**       | 阿里云 OSS                |
| **部署**       | PM2 (端口 4545)           |
| **包管理**     | pnpm                      |

### 📁 项目结构

```
app/
├── (auth)/          # 认证相关页面
├── (dashboard)/     # 管理后台
│   ├── dashboard/   # 仪表盘
│   ├── engine/      # 引擎管理
│   ├── experiment/  # 实验管理
│   ├── project/     # 项目管理
│   ├── users/       # 用户管理
│   └── ...
├── (experiment)/    # 实验参与页面
├── (guest)/         # 访客模式
└── api/             # API 路由
    ├── generate/    # 图像生成
    ├── experiment/  # 实验相关
    ├── user/        # 用户相关
    └── ...
```

### 📊 数据模型

主要实体包括：

-   **user** - 用户（支持角色、用户组、邀请码）
-   **experiment** - 实验定义
-   **experiment_steps** - 实验步骤
-   **user_experiments** - 用户参与的实验记录
-   **trail** - 实验轨迹/记录（含提示词、生成图片等）
-   **engine** - AI 图像生成引擎配置
-   **projects** / **project_group** - 项目和分组管理
-   **platform_setting** - 平台设置

### 🔄 核心业务流程

1. **实验管理**：管理员创建实验，定义多个步骤
2. **用户参与**：用户通过邀请码或直接链接参与实验
3. **写作与生成**：用户输入文字 → GPT 翻译/处理 → 调用引擎生成图片
4. **数据记录**：记录用户的每一步操作和生成结果

### 🌟 主要功能

-   ✅ 多步骤实验流程管理
-   ✅ GPT 提示词处理与翻译
-   ✅ AI 图像生成集成
-   ✅ 用户组和项目管理
-   ✅ 访客模式支持
-   ✅ 实验数据追踪和日志记录
-   ✅ 用户邀请码机制
